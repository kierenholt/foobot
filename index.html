<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <title>Ripple tank - AssemblyScript</title>
  <script src="phaser.js"></script>
  <script src="ripple.js"></script>
  <link rel="stylesheet" href="style.css">
</head>

<body onload="ready()">
  
  <canvas id="objects"></canvas>
  <canvas id="ripples"></canvas>

  <div id="settings">
    <div class="fixedHeight">
      <img src="assets/electronPositive.png" class="left" />
      <img src="assets/electronNegative.png" class="right" />
    </div>
    <input class="slider" id="setSpeedSlider" type="range"
      oninput="tank.setSpeed(this.value)" step="0.05" min="0.1" max="0.7"></input>


    <div class="fixedHeight">
      <img src="assets/electronPositive.png" class="left" />
      <img src="assets/electronNegative.png" class="right" />
    </div>
    <input class="slider" id="setFrictionSlider" type="range"
      oninput="tank.setFriction(this.value)" step="0.005" min="0" max="0.05"></input>


    <div class="fixedHeight">
      <img src="assets/electronPositive.png" class="left" />
      <img src="assets/electronNegative.png" class="right" />
    </div>
    <input class="slider" id="setHardBoundarySlider" type="range"
      oninput="tank.setHardBoundary(this.value)" step="1" min="0" max="2"></input>

    <div class="fixedHeight">
      <img src="assets/electronPositive.png" class="left" />
      <img src="assets/electronNegative.png" class="right" />
    </div>
    <input class="slider" id="setHighContrastSlider" type="range"
      oninput="tank.setHighContrast(this.value == 1)" step="1" min="0" max="1"></input>
  

      <div class="fixedHeight">
        <img src="assets/electronPositive.png" class="left" />
        <img src="assets/electronNegative.png" class="right" />
      </div>
      <input class="slider" id="setMaxAmplitudeSlider" type="range"
        oninput="tank.setMaxAmplitude(this.value)" step="0.01" min="0.01" max="1"></input>


      <div class="fixedHeight">
        <img src="assets/electronPositive.png" class="left" />
        <img src="assets/electronNegative.png" class="right" />
      </div>
      <input class="slider" id="setColourSlider" type="range"
        oninput="tank.setColour(this.value)" step="1" min="0" max="3"></input>



      <div class="fixedHeight">
        <img src="assets/electronPositive.png" class="left" />
        <img src="assets/electronNegative.png" class="right" />
      </div>
      <input class="slider" id="setFontSizeSlider" type="range"
        oninput="HoverText.setFontSize(this.value)" step="2" min="8" max="16"></input>

    <button onclick="tank.timeStep();"> time step</button>
    <button onclick="tank.play();"> play</button>
    <button onclick="tank.stop();"> pause</button>
  </div>

  <script>

    async function ready() {

      //wasm first
      var wasmModule = await wasmBrowserInstantiate("/build/untouched.wasm");
      //then ripple tank
      window["tank"] = new RippleTank(document.getElementById("ripples"), wasmModule);

      document.getElementById("setFrictionSlider").value = window["tank"].getFriction();
      document.getElementById("setSpeedSlider").value = window["tank"].getSpeed();
      document.getElementById("setHardBoundarySlider").value = window["tank"].getHardBoundary();
      document.getElementById("setHighContrastSlider").value = window["tank"].getHighContrast() ? 1 : 0;
      document.getElementById("setMaxAmplitudeSlider").value = window["tank"].getMaxAmplitude();
      document.getElementById("setColourSlider").value = window["tank"].getColour();
      document.getElementById("setFontSizeSlider").value = HoverText.FONT_SIZE;

      //game last
      var game = new myGame();
    }
    
    
  </script>

</body>

</html>